pkgname=('ffmpeg')
pkgver=4.2.2
pkgrel=4
epoch=1
pkgdesc='Complete solution to record, convert and stream audio and video'
url='https://ffmpeg.org/'
license=('GPL3')
arch=('x86_64')
depends=(
'alsa-lib'
'bzip2'
'cairo'
'fontconfig'
'fribidi'
'glib2'
'glibc'
'gmp'
'lame'
'libass.so'
'libdrm'
'libfreetype.so'
'libgcrypt'
'libgl'
'libpulse'
'librsvg'
'libva-drm.so'
'libva-x11.so'
'libva.so'
'libvorbis.so'
'libvorbisenc.so'
'libvpx.so'
'libwebp'
'libx11'
'libx264.so'
'libx265.so'
'libxcb'
'libxext'
'libxml2'
'libxv'
'libxvidcore.so'
'openjpeg2'
'openssl'
'opus'
'xz'
'zlib'
)
makedepends=(
'ffnvcodec-headers'
'frei0r-plugins'
'git'
'ladspa'
'nasm'
)
optdepends=(
'intel-media-sdk: Intel QuickSync support'
'ladspa: LADSPA filters'
)
provides=(
'libavcodec.so'
'libavdevice.so'
'libavfilter.so'
'libavformat.so'
'libavutil.so'
'libpostproc.so'
'libswresample.so'
'libswscale.so'
)
sha256sums=('SKIP')
prepare() {
cd $pkgname
if [ -x autogen.sh ]; then
	NOCONFIGURE=1 ./autogen.sh
fi
}
build() {
cd $pkgname
config_opts=(
	'--prefix=/usr'
	'--bindir=/usr/bin'
	'--libdir=/usr/lib'
	'--enable-shared'
	'--disable-static'
	'--disable-debug'
	'--assert-level=0'
	'--enable-stripping'
	'--enable-symver'
	'--enable-optimizations'
	'--enable-runtime-cpudetect'
	'--enable-swscale-alpha'
	'--disable-gray'
	'--enable-autodetect'
	'--enable-ffmpeg'
	'--enable-ffplay'
	'--enable-ffprobe'
	'--enable-avdevice'
	'--enable-avcodec'
	'--enable-avformat'
	'--enable-swresample'
	'--enable-swscale'
	'--enable-postproc'
	'--enable-avfilter'
	'--enable-pthreads'
	'--enable-network'
	'--enable-dct'
	'--enable-dwt'
	'--enable-lsp'
	'--enable-lzo'
	'--enable-mdct'
	'--enable-rdft'
	'--enable-fft'
	'--enable-faan'
	'--enable-error-resilience'
	'--enable-pixelutils'
	'--enable-gpl'
	'--enable-version3'
	'--enable-nonfree'
	'--enable-pic'
	'--enable-lto'
	'--enable-doc'
	'--enable-manpages'
	'--disable-htmlpages'
	'--disable-podpages'
	'--disable-txtpages'
	'--enable-iconv'
	'--enable-avisynth'
	'--enable-asm'
	'--enable-amd3dnow'
	'--enable-amd3dnowext'
	'--enable-mmx'
	'--enable-mmxext'
	'--enable-sse'
	'--enable-sse2'
	'--enable-sse3'
	'--enable-ssse3'
	'--enable-sse4'
	'--enable-sse42'
	'--enable-avx'
	'--enable-xop'
	'--enable-fma3'
	'--enable-fma4'
	'--enable-avx2'
	'--enable-avx512'
	'--enable-aesni'
	'--enable-inline-asm'
	'--enable-x86asm'
	'--enable-fast-unaligned'
	'--enable-alsa'
	'--disable-libaribb24'
	'--enable-bzlib'
	'--disable-libcelt'
	'--disable-chromaprint'
	'--disable-libdav1d'
	'--disable-libdavs2'
	'--disable-decklink'
	'--enable-ffnvcodec'
	'--enable-cuvid'
	'--enable-nvdec'
	'--enable-nvenc'
	'--disable-libflite'
	'--enable-libfontconfig'
	'--disable-frei0r'
	'--enable-libfribidi'
	'--enable-gmp'
	'--disable-gnutls'
	'--disable-libgsm'
	'--disable-libjack'
	'--disable-libkvazaar'
	'--disable-ladspa'
	'--enable-libmp3lame'
	'--disable-liblensfun'
	'--disable-libaom'
	'--enable-libass'
	'--disable-libbluray'
	'--disable-libbs2b'
	'--disable-libcaca'
	'--disable-libcdio'
	'--disable-opencl'
	'--disable-libcodec2'
	'--disable-libdc1394'
	'--enable-libdrm'
	'--disable-libfdk-aac'
	'--enable-libfreetype'
	'--enable-gcrypt'
	'--enable-opengl'
	'--disable-libgme'
	'--disable-libiec61883'
	'--disable-libilbc'
	'--disable-libklvanc'
	'--disable-libmfx'
	'--disable-libmodplug'
	'--disable-libmysofa'
	'--disable-omx'
	'--disable-libopenmpt'
	'--enable-libpulse'
	'--enable-librsvg'
	'--disable-librtmp'
	'--disable-libsoxr'
	'--disable-libssh'
	'--disable-libtensorflow'
	'--disable-libtheora'
	'--disable-libtls'
	'--enable-vaapi'
	'--disable-vdpau'
	'--disable-libvidstab'
	'--enable-libvorbis'
	'--enable-libvpx'
	'--enable-libwebp'
	'--enable-xlib'
	'--enable-libx264'
	'--enable-libx265'
	'--enable-libxcb'
	'--enable-libxcb-shape'
	'--enable-libxcb-shm'
	'--enable-libxcb-xfixes'
	'--enable-libxml2'
	'--enable-libxvid'
	'--disable-libzimg'
	'--disable-lv2'
	'--disable-mbedtls'
	'--disable-openal'
	'--disable-libopencore-amrnb'
	'--disable-libopencore-amrwb'
	'--disable-libopencv'
	'--disable-libopenh264'
	'--enable-libopenjpeg'
	'--enable-openssl'
	'--enable-libopus'
	'--disable-pocketsphinx'
	'--disable-rkmpp'
	'--disable-librubberband'
	'--disable-sdl2'
	'--disable-libshine'
	'--disable-libsmbclient'
	'--disable-libsnappy'
	'--disable-sndio'
	'--disable-libspeex'
	'--disable-libsrt'
	'--disable-libtesseract'
	'--disable-libtwolame'
	'--disable-libv4l2'
	'--disable-v4l2-m2m'
	'--disable-vapoursynth'
	'--disable-libvmaf'
	'--disable-libvo-amrwbenc'
	'--disable-libwavpack'
	'--disable-libxavs'
	'--disable-libxavs2'
	'--enable-lzma'
	'--disable-libzmq'
	'--enable-zlib'
	'--disable-libzvbi'
)
./configure "${config_opts[@]}"
if [ -f libtool ]; then
	sed -e "s/ -shared / $LDFLAGS\0/g" -i libtool
fi
make
make doc/{ffmpeg,ffplay}.1
}
package() {
cd $pkgname
make DESTDIR=$pkgdir install
make DESTDIR=$pkgdir install-man
}
