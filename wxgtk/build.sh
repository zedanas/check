pkgbase='wxgtk'
pkgname=('wxgtk-common' 'wxgtk3')
pkgver=3.0.4
pkgrel=2
url='https://wxwidgets.org'
license=('custom:wxWindows')
arch=('x86_64')
makedepends=(
'glu'
'gst-plugins-base'
'gtk2'
'gvfs'
'libnotify'
'libxpm'
)
source=(
"https://github.com/wxWidgets/wxWidgets/releases/download/v$pkgver/wxWidgets-$pkgver.tar.bz2"
'make-abicheck-non-fatal.patch'
)
sha256sums=(
'96157f988d261b7368e5340afa1a0cad943768f35929c22841f62c25b17bf7f0'
'46a1bb97d69163547da13d5e23a4c73e68de27ee601da5d2fb5bc5c417931453'
)
prepare() {
cd wxWidgets-$pkgver
patch -Np1 -i $srcdir/make-abicheck-non-fatal.patch
if [ -x autogen.sh ]; then
	NOCONFIGURE=1 ./autogen.sh
fi
}
build() {
cd wxWidgets-$pkgver
config_opts=(
	'--prefix=/usr'
	'--bindir=/usr/bin'
	'--sbindir=/usr/bin'
	'--libdir=/usr/lib'
	'--libexecdir=/usr/lib'
	'--sysconfdir=/etc'
	'--localstatedir=/var'
	'--enable-silent-rules'
	'--enable-shared'
	'--disable-static'
	'--disable-debug'
	'--disable-debug_flag'
	'--disable-debug_info'
	'--disable-debug_gdb'
	'--disable-profile'
	'--disable-gtktest'
	'--disable-sdltest'
	'--disable-precomp-headers'
	'--enable-optimise'
	'--enable-visibility'
	'--enable-tls'
	'--enable-stl'
	'--enable-std_containers'
	'--enable-std_iostreams'
	'--enable-std_string'
	'--enable-all-features'
	'--enable-controls'
	'--enable-gui'
	'--enable-plugins'
	'--disable-no_rtti'
	'--disable-no_deps'
	'--disable-no_exceptions'
	'--disable-compat26'
	'--disable-compat28'
	'--disable-monolithic'
	'--disable-universal'
	'--enable-gpe'
	'--enable-unicode'
	'--enable-utf8'
	'--enable-utf8only'
	'--enable-vararg_macros'
	'--enable-intl'
	'--enable-xlocale'
	'--enable-config'
	'--enable-protocols'
	'--enable-ftp'
	'--enable-http'
	'--enable-fileproto'
	'--enable-sockets'
	'--enable-dataobj'
	'--enable-ipc'
	'--enable-baseevtloop'
	'--enable-epollloop'
	'--enable-selectloop'
	'--enable-any'
	'--enable-apple_ieee'
	'--enable-arcstream'
	'--enable-base64'
	'--enable-backtrace'
	'--enable-catch_segvs'
	'--enable-cmdline'
	'--enable-datetime'
	'--enable-debugreport'
	'--enable-dialupman'
	'--enable-dynlib'
	'--enable-dynamicloader'
	'--enable-exceptions'
	'--enable-ffile'
	'--enable-file'
	'--enable-filehistory'
	'--enable-filesystem'
	'--enable-fontenum'
	'--enable-fontmap'
	'--enable-fs_archive'
	'--enable-fs_inet'
	'--enable-fs_zip'
	'--enable-fsvolume'
	'--enable-fswatcher'
	'--enable-geometry'
	'--enable-log'
	'--enable-longlong'
	'--enable-mimetype'
	'--enable-printfposparam'
	'--enable-snglinst'
	'--enable-sound'
	'--enable-stdpaths'
	'--enable-stopwatch'
	'--enable-streams'
	'--enable-sysoptions'
	'--enable-tarstream'
	'--enable-textbuf'
	'--enable-textfile'
	'--enable-timer'
	'--enable-variant'
	'--enable-zipstream'
	'--enable-url'
	'--enable-protocol'
	'--enable-protocol-http'
	'--enable-protocol-ftp'
	'--enable-protocol-file'
	'--enable-threads'
	'--enable-docview'
	'--enable-help'
	'--enable-html'
	'--enable-htmlhelp'
	'--enable-xrc'
	'--enable-aui'
	'--enable-propgrid'
	'--enable-ribbon'
	'--enable-stc'
	'--enable-constraints'
	'--enable-loggui'
	'--enable-logwin'
	'--enable-logdialog'
	'--enable-mdi'
	'--enable-mdidoc'
	'--enable-richtext'
	'--enable-postscript'
	'--enable-printarch'
	'--enable-svg'
	'--enable-webview'
	'--enable-graphics_ctx'
	'--enable-clipboard'
	'--enable-dnd'
	'--enable-markup'
	'--enable-accel'
	'--enable-animatectrl'
	'--enable-bannerwindow'
	'--enable-artstd'
	'--enable-arttango'
	'--enable-bmpbutton'
	'--enable-bmpcombobox'
	'--enable-button'
	'--enable-calendar'
	'--enable-caret'
	'--enable-checkbox'
	'--enable-checklst'
	'--enable-choice'
	'--enable-choicebook'
	'--enable-collpane'
	'--enable-colourpicker'
	'--enable-combobox'
	'--enable-comboctrl'
	'--enable-commandlinkbutton'
	'--enable-dataviewctrl'
	'--enable-datepick'
	'--enable-detect_sm'
	'--enable-dirpicker'
	'--enable-display'
	'--enable-editablebox'
	'--enable-filectrl'
	'--enable-filepicker'
	'--enable-fontpicker'
	'--enable-gauge'
	'--enable-grid'
	'--enable-headerctrl'
	'--enable-hyperlink'
	'--enable-imaglist'
	'--enable-infobar'
	'--enable-listbook'
	'--enable-listbox'
	'--enable-listctrl'
	'--enable-notebook'
	'--enable-notifmsg'
	'--enable-odcombobox'
	'--enable-popupwin'
	'--enable-prefseditor'
	'--enable-radiobox'
	'--enable-radiobtn'
	'--enable-richmsgdlg'
	'--enable-richtooltip'
	'--enable-rearrangectrl'
	'--enable-sash'
	'--enable-scrollbar'
	'--enable-searchctrl'
	'--enable-slider'
	'--enable-spinbtn'
	'--enable-spinctrl'
	'--enable-splitter'
	'--enable-statbmp'
	'--enable-statbox'
	'--enable-statline'
	'--enable-stattext'
	'--enable-statusbar'
	'--enable-taskbaricon'
	'--enable-tbarnative'
	'--enable-textctrl'
	'--enable-timepick'
	'--enable-tipwindow'
	'--enable-togglebtn'
	'--enable-toolbar'
	'--enable-toolbook'
	'--enable-treebook'
	'--enable-treectrl'
	'--enable-treelist'
	'--enable-commondlg'
	'--enable-aboutdlg'
	'--enable-choicedlg'
	'--enable-coldlg'
	'--enable-filedlg'
	'--enable-finddlg'
	'--enable-fontdlg'
	'--enable-dirdlg'
	'--enable-msgdlg'
	'--enable-numberdlg'
	'--enable-splash'
	'--enable-textdlg'
	'--enable-tipdlg'
	'--enable-progressdlg'
	'--enable-wizarddlg'
	'--enable-menus'
	'--enable-miniframe'
	'--enable-tooltips'
	'--enable-splines'
	'--enable-mousewheel'
	'--enable-validators'
	'--enable-busyinfo'
	'--enable-hotkey'
	'--enable-joystick'
	'--enable-metafiles'
	'--enable-dragimage'
	'--enable-uiactionsim'
	'--enable-dctransform'
	'--enable-webviewwebkit'
	'--enable-palette'
	'--enable-image'
	'--enable-gif'
	'--enable-pcx'
	'--enable-tga'
	'--enable-iff'
	'--enable-pnm'
	'--enable-xpm'
	'--enable-ico_cur'
	'--enable-autoidman'
	'--disable-ipv6'
	'--without-subdirs'
	'--with-regex=builtin'
	'--with-libiconv=yes'
	'--with-gtkprint=yes'
	'--with-themes=all'
	'--with-x'
	'--with-expat=sys'
	'--disable-mediactrl'
	'--disable-gstreamer8'
	'--with-gtk=3'
	'--with-gnomevfs=yes'
	'--with-opengl=yes'
	'--with-libjpeg=sys'
	'--with-libmspack=no'
	'--with-libnotify=yes'
	'--with-libpng=sys'
	'--with-libtiff=sys'
	'--with-libjbig=yes'
	'--with-liblzma=yes'
	'--with-libxpm=sys'
	'--with-sdl=no'
	'--with-zlib=sys'
)
./configure "${config_opts[@]}"
if [ -f libtool ]; then
	sed -e "s/ -shared / $LDFLAGS\0/g" -i libtool
fi
make
}
package_wxgtk-common() {
pkgdesc='Common libraries and headers for wxgtk2 and wxgtk3'
depends=(
	'expat'
	'gcc-libs'
	'glibc'
	'zlib'
)
cd wxWidgets-$pkgver
make DESTDIR=$pkgdir install
install -Dm644 docs/licence.txt $pkgdir/usr/share/licenses/wxgtk-common/LICENSE
cd $pkgdir
mkdir -p $srcdir/wxgtk3/usr/{bin,lib}
mv usr/bin/wx-config  $srcdir/wxgtk3/usr/bin/wx-config-gtk3
mv usr/lib/libwx_gtk* $srcdir/wxgtk3/usr/lib
mv usr/lib/wx $srcdir/wxgtk3/usr/lib
}
package_wxgtk3() {
pkgdesc='GTK+ implementation of wxWidgets API for GUI'
depends=(
	'bash'
	'cairo'
	'gcc-libs'
	'gdk-pixbuf2'
	'glib2'
	'glibc'
	'gtk3'
	'libglvnd'
	'libjpeg-turbo'
	'libnotify'
	'libpng'
	'libsm'
	'libtiff'
	'libx11'
	'libxxf86vm'
	'pango'
	'wxgtk-common'
)
optdepends=('webkit2gtk: for webview support')
conflicts=('wxgtk<3.0.3.1-2')
mv $srcdir/wxgtk3/* $pkgdir
install -Dm644 $srcdir/wxWidgets-$pkgver/docs/licence.txt $pkgdir/usr/share/licenses/wxgtk3/LICENSE
}
